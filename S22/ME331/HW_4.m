clear all
clc

%% initialize

v_max = [72.604, 14.5209, 7.2605
                3.63026, 2.42019, 1.81516
                1.45214, 1.21012, .90761
                .72610, .60509, .51866
                .45383, .40241, .36208
                .29048, .24207, .20750
                .18157, .16140, .14527
                .12107, .103781, .090817
                .080733, .072667, .058147
                .048469, .041556, .036371
                .029115, .0242729, .020827
                .018239, .014620, .012213];
P = [.01, .05, .1
    .2, .3 .4
    .5, .6, .7
    1, 1.2, 1.4
    1.6, 1.8, 2
    2.5, 3, 3.5
    4, 4.5, 5
    6, 7, 8
    8, 10, 12.5
    15, 17.5, 20
    25, 30, 35
    40, 50, 60];
T = 1300+273.15;

v_calc = ((8314.46/18).*(T))./(P*10.^6);

error = abs(v_max-v_calc)./v_max;
abs_error = max(max(100*error));

v_5 = [15.680, 7.1338, 3.5655
       1.78142, 1.18672, .88936
       .71095, .59200, .44332
       .35411, .20464, .25216
       .22029, .19551, .17568
       .13999, .10789, .09198
       .08644, .07652, .06858
       .06102, .051966, .045172
       .039885, .035655, .028033
       .022945, .019305, .016571
       .012736, .010175, .008348
       .006085, .005118, .003955];
   T5 = 550+273.15;
v_calc5 = ((8314.46/18).*(T5))./(P*10.^6);
error5 = abs(v_5-v_calc5)./v_5;
abs_error5 = max(max(error5));
%% plot
figure(1)
plot(v_max,P,'r-')
xlim([-1,1.2*v_max(1)])
ylim([-1,70])
hold on
plot(v_calc,P,'*k')
xlabel("Specific Volume")
ylabel("Pressure (mPa)")
legend('v-book', 'v-calculated')
hold off
figure (2)
plot(v_5,P,'.gr')
plot(v_calc5,P,'--b')
xlabel("Specific Volume")
ylabel("Pressure (mPa)")
legend('v-550','v-calculated-550')

hold off

%% P2


Pres = [3,3];

Temp = [250, 300];
spec_vol = [2644.7,2750.8];

inter = interp1(Temp,spec_vol,300);
